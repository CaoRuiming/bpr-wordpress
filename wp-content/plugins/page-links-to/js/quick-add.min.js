(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

// Copy to clipboard.
jQuery(function ($) {
	if (undefined === window.pltVars) {
		return;
	}

	var $clipboardLinks = $('.plt-copy-short-url');
	if (ClipboardJS.isSupported()) {
		$clipboardLinks.click(function (e) {
			return e.preventDefault();
		});
	} else {
		$clipboardLinks.hide();
	}

	$('.plt-links-to button').click(function (e) {
		$('#cws-links-to').focus();
	});

	var clipboard = new ClipboardJS('.plt-copy-short-url');
	var _window$pltVars = window.pltVars,
	    copied = _window$pltVars.copied,
	    browserNoSupportCopying = _window$pltVars.browserNoSupportCopying;


	clipboard.on('success', function (e) {
		var $trigger = $(e.trigger);

		$trigger.text(copied);
		setTimeout(function () {
			return $trigger.text($trigger.data('original-text'));
		}, 4000);
	});

	clipboard.on('error', function (e) {
		var $trigger = $(e.trigger);

		$trigger.text(browserNoSupportCopying);
		setTimeout(function () {
			return $clipboardLinks.hide();
		}, 4000);
	});
});

// Quick Add.
jQuery(function ($) {
	var $modal = $('#plt-quick-add');
	var $form = $modal.find('form:first');
	var $saveDraft = $('#plt-quick-add-save');
	var $publish = $('#plt-quick-add-publish');
	var $menuItem = $('a[href$="post_type=page&page=plt-add-page-link"], a[href$="#new-page-link"]');
	var $messages = $modal.find('.messages');
	var $shortUrlMessage = $modal.find('.short-url-message');
	var $title = $modal.find('[name="title"]');
	var $url = $modal.find('[name="url"]');
	var $slug = $modal.find('[name="slug"]');
	var nonce = $modal.find('[name="plt_nonce"]').val();
	var defaultSlugPlaceholder = $slug.prop('placeholder');
	var fancyUrls = window.pltVars.fancyUrls;
	var yes = true,
	    no = false;


	var modalAction = function modalAction(action) {
		return function () {
			return $modal.dialog(action);
		};
	};
	var isOpen = modalAction('isOpen');
	var open = modalAction('open');
	var close = modalAction('close');

	var makeSlugFromTitle = function makeSlugFromTitle() {
		var title = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

		return title.toLowerCase().replace(/\s+/g, '-').replace(/-{2,}/g, '-').replace(/[^a-z0-9-]/, '').replace(/-$/, '').replace(/^-/, '');
	};

	var makeSlugFromSlug = function makeSlugFromSlug() {
		var slug = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

		return slug.toLowerCase().replace(/\s+/g, '-').replace(/-{2,}/g, '-').replace(/[^a-z0-9-]/, '').replace(/^-/, '');
	};

	var addMessage = function addMessage(message) {
		var $newMessage = $('<p>' + message + '</p>');
		$messages.append($newMessage);
		return $newMessage;
	};

	var addExpiringMessage = function addExpiringMessage(message, duration) {
		var $newMessage = addMessage(message);
		setTimeout(function () {
			return $newMessage.fadeOut();
		}, duration);
		return $newMessage;
	};

	var displayShortUrlMessage = function displayShortUrlMessage(show) {
		return $shortUrlMessage.toggle(show);
	};

	var updateSlug = function updateSlug() {
		var placeholderSlug = makeSlugFromTitle($title.val());
		var slug = makeSlugFromSlug($slug.val());

		$slug.prop('placeholder', placeholderSlug.length ? placeholderSlug : defaultSlugPlaceholder);
		$slug.val(slug);
	};

	var noDefaultEvent = function noDefaultEvent(func) {
		return function (e) {
			e.preventDefault();
			func();
		};
	};

	var hardUpdateSlug = noDefaultEvent(function () {
		return $slug.val(makeSlugFromTitle($slug.val()));
	});

	var handleShowSlugMessage = noDefaultEvent(function () {
		return displayShortUrlMessage($slug.prop('placeholder').length > 16 && !$slug.val().length);
	});

	var reset = function reset() {
		$title.val('');
		$url.val('');
		$slug.val('');
		$slug.prop('placeholder', defaultSlugPlaceholder);
		maybeUpdateButtons();
	};

	var updateButtons = function updateButtons() {
		var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : yes;

		$publish.prop('disabled', !enabled);
		$saveDraft.prop('disabled', !enabled);
	};

	var maybeUpdateButtons = function maybeUpdateButtons() {
		return updateButtons($title.val().length && $url.val().length);
	};

	var submit = function submit() {
		var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
		    _ref$publish = _ref.publish,
		    publish = _ref$publish === undefined ? yes : _ref$publish;

		var title = $title.val();
		var url = $url.val();
		var slug = $slug.val() ? $slug.val() : makeSlugFromTitle(title);

		$.post(ajaxurl, {
			action: 'plt_quick_add',
			plt_title: title,
			plt_url: url,
			plt_slug: slug,
			plt_publish: publish ? 1 : 0,
			plt_nonce: nonce
		}, function (response) {
			var message = response.data.message;

			var delay = 5000;
			reset();
			$title.focus();
			addExpiringMessage(message, delay);
		});
	};

	var clickMenuItem = noDefaultEvent(function () {
		return isOpen() ? close() : open();
	});
	var saveDraft = noDefaultEvent(function () {
		return submit({ publish: no });
	});
	var publish = noDefaultEvent(function () {
		return submit({ publish: yes });
	});

	$modal.dialog({
		title: 'Add Page Link',
		dialogClass: 'wp-dialog plt-ui-dialog',
		autoOpen: no,
		draggable: no,
		width: 'auto',
		modal: yes,
		resizable: no,
		closeOnEscape: yes,
		position: {
			my: 'center',
			at: 'center',
			of: window
		},
		open: function open() {
			return $('.ui-widget-overlay').bind('click', close);
		},
		create: function create() {
			$('.plt-ui-dialog .ui-dialog-titlebar-close').addClass('ui-button');
			$('.plt-ui-dialog').css({ position: 'fixed' });
		}
	});

	var repositionModal = function repositionModal() {
		if (!isOpen()) {
			return;
		}

		$modal.dialog('option', 'position', {
			my: 'center',
			at: 'center',
			of: window
		});
	};

	$(window).scroll(repositionModal).resize(repositionModal);

	// Events.
	if (fancyUrls) {
		$title.keyup(updateSlug);
		$title.keyup(handleShowSlugMessage);
		$slug.keyup(updateSlug);
		$slug.keyup(handleShowSlugMessage);
		$form.change(hardUpdateSlug);
	}

	$menuItem.click(clickMenuItem);
	$saveDraft.click(saveDraft);
	$publish.click(publish);
	$form.submit(publish);
	$title.keyup(maybeUpdateButtons);
	$url.keyup(maybeUpdateButtons);
	$form.change(maybeUpdateButtons);

	// Init.
	reset();
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9xdWljay1hZGQuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQTtBQUNBLE9BQU8sYUFBSztBQUNYLEtBQUksY0FBYyxPQUFPLE9BQXpCLEVBQWtDO0FBQ2pDO0FBQ0E7O0FBRUQsS0FBTSxrQkFBa0IsRUFBRSxxQkFBRixDQUF4QjtBQUNBLEtBQUksWUFBWSxXQUFaLEVBQUosRUFBK0I7QUFDOUIsa0JBQWdCLEtBQWhCLENBQXNCO0FBQUEsVUFBSyxFQUFFLGNBQUYsRUFBTDtBQUFBLEdBQXRCO0FBQ0EsRUFGRCxNQUVPO0FBQ04sa0JBQWdCLElBQWhCO0FBQ0E7O0FBRUQsR0FBRSxzQkFBRixFQUEwQixLQUExQixDQUFnQyxhQUFLO0FBQ3BDLElBQUUsZUFBRixFQUFtQixLQUFuQjtBQUNBLEVBRkQ7O0FBSUEsS0FBTSxZQUFZLElBQUksV0FBSixDQUFnQixxQkFBaEIsQ0FBbEI7QUFoQlcsdUJBaUJpQyxPQUFPLE9BakJ4QztBQUFBLEtBaUJILE1BakJHLG1CQWlCSCxNQWpCRztBQUFBLEtBaUJLLHVCQWpCTCxtQkFpQkssdUJBakJMOzs7QUFtQlgsV0FBVSxFQUFWLENBQWEsU0FBYixFQUF3QixhQUFLO0FBQzVCLE1BQU0sV0FBVyxFQUFFLEVBQUUsT0FBSixDQUFqQjs7QUFFQSxXQUFTLElBQVQsQ0FBYyxNQUFkO0FBQ0EsYUFBVztBQUFBLFVBQU0sU0FBUyxJQUFULENBQWMsU0FBUyxJQUFULENBQWMsZUFBZCxDQUFkLENBQU47QUFBQSxHQUFYLEVBQWdFLElBQWhFO0FBQ0EsRUFMRDs7QUFPQSxXQUFVLEVBQVYsQ0FBYSxPQUFiLEVBQXNCLGFBQUs7QUFDMUIsTUFBTSxXQUFXLEVBQUUsRUFBRSxPQUFKLENBQWpCOztBQUVBLFdBQVMsSUFBVCxDQUFjLHVCQUFkO0FBQ0EsYUFBVztBQUFBLFVBQU0sZ0JBQWdCLElBQWhCLEVBQU47QUFBQSxHQUFY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RixFQUF3QixJQUF4QixDQUE2QixPQUE3QixFQUFzQyxLQUF0QyxDQUFOO0FBQUEsR0FkTztBQWViLFVBQVEsa0JBQU07QUFDYixLQUFFLDBDQUFGLEVBQThDLFFBQTlDLENBQXVELFdBQXZEO0FBQ0EsS0FBRSxnQkFBRixFQUFvQixHQUFwQixDQUF3QixFQUFFLFVBQVUsT0FBWixFQUF4QjtBQUNBO0FBbEJZLEVBQWQ7O0FBcUJBLEtBQU0sa0JBQWtCLFNBQWxCLGVBQWtCLEdBQU07QUFDN0IsTUFBSSxDQUFDLFFBQUwsRUFBZTtBQUNkO0FBQ0E7O0FBRUQsU0FBTyxNQUFQLENBQWMsUUFBZCxFQUF3QixVQUF4QixFQUFvQztBQUNuQyxPQUFJLFFBRCtCO0FBRW5DLE9BQUksUUFGK0I7QUFHbkMsT0FBSTtBQUgrQixHQUFwQztBQUtBLEVBVkQ7O0FBWUEsR0FBRSxNQUFGLEVBQ0UsTUFERixDQUNTLGVBRFQsRUFFRSxNQUZGLENBRVMsZUFGVDs7QUFJQTtBQUNBLEtBQUksU0FBSixFQUFlO0FBQ2QsU0FBTyxLQUFQLENBQWEsVUFBYjtBQUNBLFNBQU8sS0FBUCxDQUFhLHFCQUFiO0FBQ0EsUUFBTSxLQUFOLENBQVksVUFBWjtBQUNBLFFBQU0sS0FBTixDQUFZLHFCQUFaO0FBQ0EsUUFBTSxNQUFOLENBQWEsY0FBYjtBQUNBOztBQUVELFdBQVUsS0FBVixDQUFnQixhQUFoQjtBQUNBLFlBQVcsS0FBWCxDQUFpQixTQUFqQjtBQUNBLFVBQVMsS0FBVCxDQUFlLE9BQWY7QUFDQSxPQUFNLE1BQU4sQ0FBYSxPQUFiO0FBQ0EsUUFBTyxLQUFQLENBQWEsa0JBQWI7QUFDQSxNQUFLLEtBQUwsQ0FBVyxrQkFBWDtBQUNBLE9BQU0sTUFBTixDQUFhLGtCQUFiOztBQUVBO0FBQ0E7QUFDQSxDQXZMRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8vIENvcHkgdG8gY2xpcGJvYXJkLlxualF1ZXJ5KCQgPT4ge1xuXHRpZiAodW5kZWZpbmVkID09PSB3aW5kb3cucGx0VmFycykge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0ICRjbGlwYm9hcmRMaW5rcyA9ICQoJy5wbHQtY29weS1zaG9ydC11cmwnKTtcblx0aWYgKENsaXBib2FyZEpTLmlzU3VwcG9ydGVkKCkpIHtcblx0XHQkY2xpcGJvYXJkTGlua3MuY2xpY2soZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xuXHR9IGVsc2Uge1xuXHRcdCRjbGlwYm9hcmRMaW5rcy5oaWRlKCk7XG5cdH1cblxuXHQkKCcucGx0LWxpbmtzLXRvIGJ1dHRvbicpLmNsaWNrKGUgPT4ge1xuXHRcdCQoJyNjd3MtbGlua3MtdG8nKS5mb2N1cygpO1xuXHR9KTtcblxuXHRjb25zdCBjbGlwYm9hcmQgPSBuZXcgQ2xpcGJvYXJkSlMoJy5wbHQtY29weS1zaG9ydC11cmwnKTtcblx0Y29uc3QgeyBjb3BpZWQsIGJyb3dzZXJOb1N1cHBvcnRDb3B5aW5nIH0gPSB3aW5kb3cucGx0VmFycztcblxuXHRjbGlwYm9hcmQub24oJ3N1Y2Nlc3MnLCBlID0+IHtcblx0XHRjb25zdCAkdHJpZ2dlciA9ICQoZS50cmlnZ2VyKTtcblxuXHRcdCR0cmlnZ2VyLnRleHQoY29waWVkKTtcblx0XHRzZXRUaW1lb3V0KCgpID0+ICR0cmlnZ2VyLnRleHQoJHRyaWdnZXIuZGF0YSgnb3JpZ2luYWwtdGV4dCcpKSwgNDAwMCk7XG5cdH0pO1xuXG5cdGNsaXBib2FyZC5vbignZXJyb3InLCBlID0+IHtcblx0XHRjb25zdCAkdHJpZ2dlciA9ICQoZS50cmlnZ2VyKTtcblxuXHRcdCR0cmlnZ2VyLnRleHQoYnJvd3Nlck5vU3VwcG9ydENvcHlpbmcpO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4gJGNsaXBib2FyZExpbmtzLmhpZGUoKSwgNDAwMCk7XG5cdH0pO1xufSk7XG5cbi8vIFF1aWNrIEFkZC5cbmpRdWVyeSgkID0+IHtcblx0Y29uc3QgJG1vZGFsID0gJCgnI3BsdC1xdWljay1hZGQnKTtcblx0Y29uc3QgJGZvcm0gPSAkbW9kYWwuZmluZCgnZm9ybTpmaXJzdCcpO1xuXHRjb25zdCAkc2F2ZURyYWZ0ID0gJCgnI3BsdC1xdWljay1hZGQtc2F2ZScpO1xuXHRjb25zdCAkcHVibGlzaCA9ICQoJyNwbHQtcXVpY2stYWRkLXB1Ymxpc2gnKTtcblx0Y29uc3QgJG1lbnVJdGVtID0gJChcblx0XHQnYVtocmVmJD1cInBvc3RfdHlwZT1wYWdlJnBhZ2U9cGx0LWFkZC1wYWdlLWxpbmtcIl0sIGFbaHJlZiQ9XCIjbmV3LXBhZ2UtbGlua1wiXSdcblx0KTtcblx0Y29uc3QgJG1lc3NhZ2VzID0gJG1vZGFsLmZpbmQoJy5tZXNzYWdlcycpO1xuXHRjb25zdCAkc2hvcnRVcmxNZXNzYWdlID0gJG1vZGFsLmZpbmQoJy5zaG9ydC11cmwtbWVzc2FnZScpO1xuXHRjb25zdCAkdGl0bGUgPSAkbW9kYWwuZmluZCgnW25hbWU9XCJ0aXRsZVwiXScpO1xuXHRjb25zdCAkdXJsID0gJG1vZGFsLmZpbmQoJ1tuYW1lPVwidXJsXCJdJyk7XG5cdGNvbnN0ICRzbHVnID0gJG1vZGFsLmZpbmQoJ1tuYW1lPVwic2x1Z1wiXScpO1xuXHRjb25zdCBub25jZSA9ICRtb2RhbC5maW5kKCdbbmFtZT1cInBsdF9ub25jZVwiXScpLnZhbCgpO1xuXHRjb25zdCBkZWZhdWx0U2x1Z1BsYWNlaG9sZGVyID0gJHNsdWcucHJvcCgncGxhY2Vob2xkZXInKTtcblx0Y29uc3QgZmFuY3lVcmxzID0gd2luZG93LnBsdFZhcnMuZmFuY3lVcmxzO1xuXHRjb25zdCBbeWVzLCBub10gPSBbdHJ1ZSwgZmFsc2VdO1xuXG5cdGNvbnN0IG1vZGFsQWN0aW9uID0gYWN0aW9uID0+ICgpID0+ICRtb2RhbC5kaWFsb2coYWN0aW9uKTtcblx0Y29uc3QgaXNPcGVuID0gbW9kYWxBY3Rpb24oJ2lzT3BlbicpO1xuXHRjb25zdCBvcGVuID0gbW9kYWxBY3Rpb24oJ29wZW4nKTtcblx0Y29uc3QgY2xvc2UgPSBtb2RhbEFjdGlvbignY2xvc2UnKTtcblxuXHRjb25zdCBtYWtlU2x1Z0Zyb21UaXRsZSA9ICh0aXRsZSA9ICcnKSA9PiB7XG5cdFx0cmV0dXJuIHRpdGxlXG5cdFx0XHQudG9Mb3dlckNhc2UoKVxuXHRcdFx0LnJlcGxhY2UoL1xccysvZywgJy0nKVxuXHRcdFx0LnJlcGxhY2UoLy17Mix9L2csICctJylcblx0XHRcdC5yZXBsYWNlKC9bXmEtejAtOS1dLywgJycpXG5cdFx0XHQucmVwbGFjZSgvLSQvLCAnJylcblx0XHRcdC5yZXBsYWNlKC9eLS8sICcnKTtcblx0fTtcblxuXHRjb25zdCBtYWtlU2x1Z0Zyb21TbHVnID0gKHNsdWcgPSAnJykgPT4ge1xuXHRcdHJldHVybiBzbHVnXG5cdFx0XHQudG9Mb3dlckNhc2UoKVxuXHRcdFx0LnJlcGxhY2UoL1xccysvZywgJy0nKVxuXHRcdFx0LnJlcGxhY2UoLy17Mix9L2csICctJylcblx0XHRcdC5yZXBsYWNlKC9bXmEtejAtOS1dLywgJycpXG5cdFx0XHQucmVwbGFjZSgvXi0vLCAnJyk7XG5cdH07XG5cblx0Y29uc3QgYWRkTWVzc2FnZSA9IG1lc3NhZ2UgPT4ge1xuXHRcdGNvbnN0ICRuZXdNZXNzYWdlID0gJChgPHA+JHttZXNzYWdlfTwvcD5gKTtcblx0XHQkbWVzc2FnZXMuYXBwZW5kKCRuZXdNZXNzYWdlKTtcblx0XHRyZXR1cm4gJG5ld01lc3NhZ2U7XG5cdH07XG5cblx0Y29uc3QgYWRkRXhwaXJpbmdNZXNzYWdlID0gKG1lc3NhZ2UsIGR1cmF0aW9uKSA9PiB7XG5cdFx0Y29uc3QgJG5ld01lc3NhZ2UgPSBhZGRNZXNzYWdlKG1lc3NhZ2UpO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4gJG5ld01lc3NhZ2UuZmFkZU91dCgpLCBkdXJhdGlvbik7XG5cdFx0cmV0dXJuICRuZXdNZXNzYWdlO1xuXHR9O1xuXG5cdGNvbnN0IGRpc3BsYXlTaG9ydFVybE1lc3NhZ2UgPSBzaG93ID0+ICRzaG9ydFVybE1lc3NhZ2UudG9nZ2xlKHNob3cpO1xuXG5cdGNvbnN0IHVwZGF0ZVNsdWcgPSAoKSA9PiB7XG5cdFx0Y29uc3QgcGxhY2Vob2xkZXJTbHVnID0gbWFrZVNsdWdGcm9tVGl0bGUoJHRpdGxlLnZhbCgpKTtcblx0XHRjb25zdCBzbHVnID0gbWFrZVNsdWdGcm9tU2x1Zygkc2x1Zy52YWwoKSk7XG5cblx0XHQkc2x1Zy5wcm9wKFxuXHRcdFx0J3BsYWNlaG9sZGVyJyxcblx0XHRcdHBsYWNlaG9sZGVyU2x1Zy5sZW5ndGggPyBwbGFjZWhvbGRlclNsdWcgOiBkZWZhdWx0U2x1Z1BsYWNlaG9sZGVyXG5cdFx0KTtcblx0XHQkc2x1Zy52YWwoc2x1Zyk7XG5cdH07XG5cblx0Y29uc3Qgbm9EZWZhdWx0RXZlbnQgPSBmdW5jID0+IGUgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRmdW5jKCk7XG5cdH07XG5cblx0Y29uc3QgaGFyZFVwZGF0ZVNsdWcgPSBub0RlZmF1bHRFdmVudCgoKSA9PlxuXHRcdCRzbHVnLnZhbChtYWtlU2x1Z0Zyb21UaXRsZSgkc2x1Zy52YWwoKSkpXG5cdCk7XG5cblx0Y29uc3QgaGFuZGxlU2hvd1NsdWdNZXNzYWdlID0gbm9EZWZhdWx0RXZlbnQoKCkgPT5cblx0XHRkaXNwbGF5U2hvcnRVcmxNZXNzYWdlKFxuXHRcdFx0JHNsdWcucHJvcCgncGxhY2Vob2xkZXInKS5sZW5ndGggPiAxNiAmJiAhJHNsdWcudmFsKCkubGVuZ3RoXG5cdFx0KVxuXHQpO1xuXG5cdGNvbnN0IHJlc2V0ID0gKCkgPT4ge1xuXHRcdCR0aXRsZS52YWwoJycpO1xuXHRcdCR1cmwudmFsKCcnKTtcblx0XHQkc2x1Zy52YWwoJycpO1xuXHRcdCRzbHVnLnByb3AoJ3BsYWNlaG9sZGVyJywgZGVmYXVsdFNsdWdQbGFjZWhvbGRlcik7XG5cdFx0bWF5YmVVcGRhdGVCdXR0b25zKCk7XG5cdH07XG5cblx0Y29uc3QgdXBkYXRlQnV0dG9ucyA9IChlbmFibGVkID0geWVzKSA9PiB7XG5cdFx0JHB1Ymxpc2gucHJvcCgnZGlzYWJsZWQnLCAhZW5hYmxlZCk7XG5cdFx0JHNhdmVEcmFmdC5wcm9wKCdkaXNhYmxlZCcsICFlbmFibGVkKTtcblx0fTtcblxuXHRjb25zdCBtYXliZVVwZGF0ZUJ1dHRvbnMgPSAoKSA9PlxuXHRcdHVwZGF0ZUJ1dHRvbnMoJHRpdGxlLnZhbCgpLmxlbmd0aCAmJiAkdXJsLnZhbCgpLmxlbmd0aCk7XG5cblx0Y29uc3Qgc3VibWl0ID0gKHsgcHVibGlzaCA9IHllcyB9ID0ge30pID0+IHtcblx0XHRjb25zdCB0aXRsZSA9ICR0aXRsZS52YWwoKTtcblx0XHRjb25zdCB1cmwgPSAkdXJsLnZhbCgpO1xuXHRcdGxldCBzbHVnID0gJHNsdWcudmFsKCkgPyAkc2x1Zy52YWwoKSA6IG1ha2VTbHVnRnJvbVRpdGxlKHRpdGxlKTtcblxuXHRcdCQucG9zdChcblx0XHRcdGFqYXh1cmwsXG5cdFx0XHR7XG5cdFx0XHRcdGFjdGlvbjogJ3BsdF9xdWlja19hZGQnLFxuXHRcdFx0XHRwbHRfdGl0bGU6IHRpdGxlLFxuXHRcdFx0XHRwbHRfdXJsOiB1cmwsXG5cdFx0XHRcdHBsdF9zbHVnOiBzbHVnLFxuXHRcdFx0XHRwbHRfcHVibGlzaDogcHVibGlzaCA/IDEgOiAwLFxuXHRcdFx0XHRwbHRfbm9uY2U6IG5vbmNlLFxuXHRcdFx0fSxcblx0XHRcdHJlc3BvbnNlID0+IHtcblx0XHRcdFx0Y29uc3QgeyBtZXNzYWdlIH0gPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHRjb25zdCBkZWxheSA9IDUwMDA7XG5cdFx0XHRcdHJlc2V0KCk7XG5cdFx0XHRcdCR0aXRsZS5mb2N1cygpO1xuXHRcdFx0XHRhZGRFeHBpcmluZ01lc3NhZ2UobWVzc2FnZSwgZGVsYXkpO1xuXHRcdFx0fVxuXHRcdCk7XG5cdH07XG5cblx0Y29uc3QgY2xpY2tNZW51SXRlbSA9IG5vRGVmYXVsdEV2ZW50KCgpID0+IChpc09wZW4oKSA/IGNsb3NlKCkgOiBvcGVuKCkpKTtcblx0Y29uc3Qgc2F2ZURyYWZ0ID0gbm9EZWZhdWx0RXZlbnQoKCkgPT4gc3VibWl0KHsgcHVibGlzaDogbm8gfSkpO1xuXHRjb25zdCBwdWJsaXNoID0gbm9EZWZhdWx0RXZlbnQoKCkgPT4gc3VibWl0KHsgcHVibGlzaDogeWVzIH0pKTtcblxuXHQkbW9kYWwuZGlhbG9nKHtcblx0XHR0aXRsZTogJ0FkZCBQYWdlIExpbmsnLFxuXHRcdGRpYWxvZ0NsYXNzOiAnd3AtZGlhbG9nIHBsdC11aS1kaWFsb2cnLFxuXHRcdGF1dG9PcGVuOiBubyxcblx0XHRkcmFnZ2FibGU6IG5vLFxuXHRcdHdpZHRoOiAnYXV0bycsXG5cdFx0bW9kYWw6IHllcyxcblx0XHRyZXNpemFibGU6IG5vLFxuXHRcdGNsb3NlT25Fc2NhcGU6IHllcyxcblx0XHRwb3NpdGlvbjoge1xuXHRcdFx0bXk6ICdjZW50ZXInLFxuXHRcdFx0YXQ6ICdjZW50ZXInLFxuXHRcdFx0b2Y6IHdpbmRvdyxcblx0XHR9LFxuXHRcdG9wZW46ICgpID0+ICQoJy51aS13aWRnZXQtb3ZlcmxheScpLmJpbmQoJ2NsaWNrJywgY2xvc2UpLFxuXHRcdGNyZWF0ZTogKCkgPT4ge1xuXHRcdFx0JCgnLnBsdC11aS1kaWFsb2cgLnVpLWRpYWxvZy10aXRsZWJhci1jbG9zZScpLmFkZENsYXNzKCd1aS1idXR0b24nKTtcblx0XHRcdCQoJy5wbHQtdWktZGlhbG9nJykuY3NzKHsgcG9zaXRpb246ICdmaXhlZCcgfSk7XG5cdFx0fSxcblx0fSk7XG5cblx0Y29uc3QgcmVwb3NpdGlvbk1vZGFsID0gKCkgPT4ge1xuXHRcdGlmICghaXNPcGVuKCkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQkbW9kYWwuZGlhbG9nKCdvcHRpb24nLCAncG9zaXRpb24nLCB7XG5cdFx0XHRteTogJ2NlbnRlcicsXG5cdFx0XHRhdDogJ2NlbnRlcicsXG5cdFx0XHRvZjogd2luZG93LFxuXHRcdH0pO1xuXHR9O1xuXG5cdCQod2luZG93KVxuXHRcdC5zY3JvbGwocmVwb3NpdGlvbk1vZGFsKVxuXHRcdC5yZXNpemUocmVwb3NpdGlvbk1vZGFsKTtcblxuXHQvLyBFdmVudHMuXG5cdGlmIChmYW5jeVVybHMpIHtcblx0XHQkdGl0bGUua2V5dXAodXBkYXRlU2x1Zyk7XG5cdFx0JHRpdGxlLmtleXVwKGhhbmRsZVNob3dTbHVnTWVzc2FnZSk7XG5cdFx0JHNsdWcua2V5dXAodXBkYXRlU2x1Zyk7XG5cdFx0JHNsdWcua2V5dXAoaGFuZGxlU2hvd1NsdWdNZXNzYWdlKTtcblx0XHQkZm9ybS5jaGFuZ2UoaGFyZFVwZGF0ZVNsdWcpO1xuXHR9XG5cblx0JG1lbnVJdGVtLmNsaWNrKGNsaWNrTWVudUl0ZW0pO1xuXHQkc2F2ZURyYWZ0LmNsaWNrKHNhdmVEcmFmdCk7XG5cdCRwdWJsaXNoLmNsaWNrKHB1Ymxpc2gpO1xuXHQkZm9ybS5zdWJtaXQocHVibGlzaCk7XG5cdCR0aXRsZS5rZXl1cChtYXliZVVwZGF0ZUJ1dHRvbnMpO1xuXHQkdXJsLmtleXVwKG1heWJlVXBkYXRlQnV0dG9ucyk7XG5cdCRmb3JtLmNoYW5nZShtYXliZVVwZGF0ZUJ1dHRvbnMpO1xuXG5cdC8vIEluaXQuXG5cdHJlc2V0KCk7XG59KTtcbiJdfQ==
