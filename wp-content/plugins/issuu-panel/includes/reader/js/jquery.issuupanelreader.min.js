var $nav,$ul,$prev,$next,$iframe,$tools,keyMap={16:!1,17:!1,37:!1,38:!1,39:!1,40:!1};!function(a){a.fn.issuuPanelReader=function(b){var c={prevNavigation:"#ip-reader-prev",nextNavigation:"#ip-reader-next",zoomMax:".ip-zoom-max",zoomMore:".ip-zoom-more",zoomMinus:".ip-zoom-minus",zoomMin:".ip-zoom-min",closeReader:".ip-close-reader"};return a.issuuPanelReaderIframe=a(this).contents(),a.issuuPanelReader={zoom:100},a(this).on("mousedown",function(b){a(this).on("mousemove",function(c){a.issuuPanelReaderIframe.find("html,body").stop(!1,!0).animate({scrollLeft:b.pageX-c.clientX})})}),a(this).on("mouseup",function(){a(this).off("mousemove")}),b=a.extend({},c,b),a(b.prevNavigation).click(function(b){b.preventDefault();var c=a.issuuPanelReaderIframe.find(".ip-doc-active"),d=c.find("img").data("ip-reader-page");d>1&&(d--,a.issuuPanelReader.zoom=100,c.removeClass("ip-doc-active"),a.issuuPanelReaderIframe.find('[data-ip-reader-page="'+d+'"]').parent().addClass("ip-doc-active"),a.issuuPanelReaderIframe.find("body").css({zoom:a.issuuPanelReader.zoom+"%"}))}),a(b.nextNavigation).click(function(b){b.preventDefault();var c=parseInt(a.issuuPanelReaderIframe.find("#issuu-panel-document").data("ip-reader-pages")),d=a.issuuPanelReaderIframe.find(".ip-doc-active"),e=d.find("img").data("ip-reader-page");c>e&&(e++,a.issuuPanelReader.zoom=100,d.removeClass("ip-doc-active"),a.issuuPanelReaderIframe.find('[data-ip-reader-page="'+e+'"]').parent().addClass("ip-doc-active"),a.issuuPanelReaderIframe.find("body").css({zoom:a.issuuPanelReader.zoom+"%"}))}),a(b.zoomMax).click(function(b){b.preventDefault(),a.issuuPanelReader.zoom<500&&(a.issuuPanelReader.zoom=500,a.issuuPanelReaderIframe.find("#issuu-panel-document").css({zoom:a.issuuPanelReader.zoom+"%"}))}),a(b.zoomMore).click(function(b){b.preventDefault(),a.issuuPanelReader.zoom<500&&(a.issuuPanelReader.zoom+=a.issuuPanelReader.zoom<200?10:20),a.issuuPanelReaderIframe.find("#issuu-panel-document").css({zoom:a.issuuPanelReader.zoom+"%"})}),a(b.zoomMinus).click(function(b){b.preventDefault(),a.issuuPanelReader.zoom>100&&(a.issuuPanelReader.zoom-=a.issuuPanelReader.zoom>200?20:10),a.issuuPanelReaderIframe.find("#issuu-panel-document").css({zoom:a.issuuPanelReader.zoom+"%"})}),a(b.zoomMin).click(function(b){b.preventDefault(),a.issuuPanelReader.zoom>100&&(a.issuuPanelReader.zoom=100,a.issuuPanelReaderIframe.find("#issuu-panel-document").css({zoom:a.issuuPanelReader.zoom+"%"}))}),a(b.closeReader).click(function(){a("#issuu-panel-reader").fadeOut(500,function(){a(this).remove(),$iframe=null,a(window).unbind("keyup").unbind("keydown"),a("body").removeClass("issuu-panel-noscroll")})}),a(document).keydown(function(c){switch(c.keyCode){case 27:a(b.closeReader).trigger("click");break;default:if(c.keyCode in keyMap){if(keyMap[c.keyCode]=!0,keyMap[17]&&keyMap[37])return a(b.prevNavigation).trigger("click"),!1;if(keyMap[17]&&keyMap[16]&&keyMap[38])return a(b.zoomMax).trigger("click"),!1;if(keyMap[17]&&keyMap[38])return a(b.zoomMore).trigger("click"),!1;if(keyMap[17]&&keyMap[39])return a(b.nextNavigation).trigger("click"),!1;if(keyMap[17]&&keyMap[16]&&keyMap[40])return a(b.zoomMin).trigger("click"),!1;if(keyMap[17]&&keyMap[40])return a(b.zoomMinus).trigger("click"),!1}}}).keyup(function(a){a.keyCode in keyMap&&(keyMap[a.keyCode]=!1)}),this}}(jQuery);